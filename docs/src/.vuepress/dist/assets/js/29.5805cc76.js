(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{381:function(e,t,s){"use strict";s.r(t);var a=s(42),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"troubleshooting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[e._v("#")]),e._v(" Troubleshooting")]),e._v(" "),s("p",[e._v("Euh oh, quelque chose a mal tourné ? Utilisez ce guide pour résoudre les problèmes avec Jest.")]),e._v(" "),s("h2",{attrs:{id:"les-tests-echouent-et-vous-ne-savez-pas-pourquoi"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#les-tests-echouent-et-vous-ne-savez-pas-pourquoi"}},[e._v("#")]),e._v(" Les tests échouent et vous ne savez pas pourquoi")]),e._v(" "),s("p",[e._v("Essayez d'utiliser le support de débogage intégré à Node. Note : Cela ne fonctionnera que dans Node.js 8+.")]),e._v(" "),s("p",[e._v("Placez une instruction "),s("code",[e._v("debugger;")]),e._v(" dans l'un de vos tests, puis, dans le répertoire de votre projet, lancez :")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("node --inspect-brk node_modules/.bin/jest --runInBand "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("any other arguments here"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\nor on Windows\nnode --inspect-brk ./node_modules/jest/bin/jest.js --runInBand "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("any other arguments here"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),s("p",[e._v("Jest fonctionnera ainsi dans un processus Node auquel un débogueur externe pourra se connecter. Notez que le processus s'arrêtera jusqu'à ce que le débogueur s'y connecte.")]),e._v(" "),s("p",[e._v("Pour déboguer dans Google Chrome (ou tout autre navigateur basé sur Chromium), ouvrez votre navigateur et allez dans "),s("code",[e._v("chrome://inspect")]),e._v(' et cliquez sur "Open Dedicated DevTools for Node", ce qui vous donnera une liste des instances de nœuds disponibles auxquelles vous pouvez vous connecter. Cliquez sur l\'adresse affichée dans le terminal (généralement quelque chose comme '),s("code",[e._v("localhost:9229")]),e._v(") après avoir exécuté la commande ci-dessus, et vous pourrez déboguer Jest en utilisant les DevTools de Chrome.")]),e._v(" "),s("p",[e._v("Les outils de développement Chrome seront affichés et un point d'arrêt sera fixé à la première ligne du script CLI de Jest (ceci est fait pour vous donner le temps d'ouvrir les outils de développement et pour empêcher que Jest ne s'exécute avant que vous n'ayez le temps de le faire). Cliquez sur le bouton qui ressemble à un bouton \"play\" en haut à droite de l'écran pour continuer l'exécution. Lorsque Jest exécute le test qui contient l'instruction "),s("code",[e._v("debugger")]),e._v(", l'exécution s'arrête et vous pouvez examiner la portée actuelle et la pile d'appels.")]),e._v(" "),s("blockquote",[s("p",[e._v("Note : l'option "),s("code",[e._v("--runInBand")]),e._v(" cli permet de s'assurer que Jest exécute le test dans le même processus plutôt que d'engendrer des processus pour des tests individuels. Normalement, Jest parallélise les tests entre les processus, mais il est difficile de déboguer plusieurs processus en même temps.")])]),e._v(" "),s("h2",{attrs:{id:"debugger-dans-vs-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#debugger-dans-vs-code"}},[e._v("#")]),e._v(" Débugger dans VS Code")]),e._v(" "),s("p",[e._v("Il existe plusieurs façons de déboguer les tests Jest avec le "),s("a",{attrs:{href:"https://code.visualstudio.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("code de Visual Studio"),s("OutboundLink")],1),e._v(" intégré au "),s("a",{attrs:{href:"https://code.visualstudio.com/docs/nodejs/nodejs-debugging",target:"_blank",rel:"noopener noreferrer"}},[e._v("débogueur"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Pour attacher le débogueur intégré, effectuez vos tests comme indiqué ci-dessus :")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("node --inspect-brk node_modules/.bin/jest --runInBand "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("any other arguments here"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\nor on Windows\nnode --inspect-brk ./node_modules/jest/bin/jest.js --runInBand "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("any other arguments here"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])]),s("p",[e._v("Attachez ensuite le débogueur de VS Code en utilisant la configuration suivante "),s("code",[e._v("launch.json")]),e._v(" :")]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.2.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"configurations"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"node"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"request"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"attach"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Attach"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"port"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("9229")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("p",[e._v("Pour lancer et joindre automatiquement un processus exécutant vos tests, utilisez la configuration suivante :")]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.2.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"configurations"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Debug Jest Tests"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"node"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"request"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"launch"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"runtimeArgs"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--inspect-brk"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${workspaceRoot}/node_modules/.bin/jest"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--runInBand"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"console"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"integratedTerminal"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"internalConsoleOptions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"neverOpen"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"port"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("9229")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("p",[e._v("ou le code suivant pour Windows :")]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.2.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"configurations"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Debug Jest Tests"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"node"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"request"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"launch"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"runtimeArgs"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--inspect-brk"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${workspaceRoot}/node_modules/jest/bin/jest.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--runInBand"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"console"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"integratedTerminal"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"internalConsoleOptions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"neverOpen"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"port"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("9229")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("p",[e._v("Si vous utilisez la "),s("a",{attrs:{href:"https://github.com/facebookincubator/create-react-app",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("create-react-app")]),s("OutboundLink")],1),e._v(" de Facebook, vous pouvez déboguer vos tests Jest avec la configuration suivante :")]),e._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.2.0"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"configurations"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Debug CRA Tests"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"node"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"request"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"launch"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"runtimeExecutable"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${workspaceRoot}/node_modules/.bin/react-scripts"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"args"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--runInBand"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--no-cache"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--env=jsdom"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"cwd"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${workspaceRoot}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"protocol"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"inspector"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"console"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"integratedTerminal"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[e._v('"internalConsoleOptions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"neverOpen"')]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("p",[e._v("Vous trouverez de plus amples informations sur le débogage des nœuds "),s("a",{attrs:{href:"https://nodejs.org/api/debugger.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ici"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"debugger-dans-webstorm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#debugger-dans-webstorm"}},[e._v("#")]),e._v(" Débugger dans WebStorm")]),e._v(" "),s("p",[e._v("La façon la plus simple de déboguer les tests Jest dans "),s("a",{attrs:{href:"https://www.jetbrains.com/webstorm/",target:"_blank",rel:"noopener noreferrer"}},[e._v("WebStorm"),s("OutboundLink")],1),e._v(' est d\'utiliser la configuration "Jest run/debug". Il lancera les tests et attachera automatiquement le débogueur.')]),e._v(" "),s("p",[e._v('Dans le menu WebStorm "Run", sélectionnez "Edit Configurations...". Ensuite, cliquez sur "+" et sélectionnez "Jest". Spécifiez éventuellement le fichier de configuration Jest, les options supplémentaires et les variables d\'environnement. Sauvegardez la configuration, mettez les points d\'arrêt dans le code, puis cliquez sur l\'icône verte de débogage pour commencer le débogage.')]),e._v(" "),s("p",[e._v("Si vous utilisez la ["),s("code",[e._v("create-react-app")]),e._v("] (https://github.com/facebookincubator/create-react-app) de Facebook, dans la configuration de Jest run/debug, indiquez le chemin du paquet "),s("code",[e._v("react-scripts")]),e._v(" dans le champ du paquet Jest et ajoutez "),s("code",[e._v("--env=jsdom")]),e._v(" au champ des options de Jest.")]),e._v(" "),s("h2",{attrs:{id:"question-de-mis-en-cache"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#question-de-mis-en-cache"}},[e._v("#")]),e._v(" Question de mis en cache")]),e._v(" "),s("p",[e._v("Le script de transformation a été modifié ou Babel a été mis à jour et les changements ne sont pas reconnus par Jest ?")]),e._v(" "),s("p",[e._v("Réessayez avec "),s("RouterLink",{attrs:{to:"/jest/Guides/CLI.html#--cache"}},[s("code",[e._v("--no-cache")])]),e._v(". Jest caches a transformé les fichiers des modules pour accélérer l'exécution des tests. Si vous utilisez votre propre transformateur personnalisé, pensez à y ajouter une fonction "),s("code",[e._v("getCacheKey")]),e._v(" : "),s("a",{attrs:{href:"https://github.com/facebook/relay/blob/58cf36c73769690f0bbf90562707eadb062b029d/scripts/jest/preprocessor.js#L56-L61",target:"_blank",rel:"noopener noreferrer"}},[e._v("getCacheKey in Relay"),s("OutboundLink")],1),e._v(".")],1),e._v(" "),s("h2",{attrs:{id:"promesses-non-tenues"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#promesses-non-tenues"}},[e._v("#")]),e._v(" Promesses non tenues")]),e._v(" "),s("p",[e._v("Si une promesse ne se concrétise pas du tout, cette erreur risque d'être rejetée :")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("- Error: Timeout - Async callback was not invoked within "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("timeout")]),e._v(" specified by jasmine.DEFAULT_TIMEOUT_INTERVAL.`\n")])])]),s("p",[e._v("Le plus souvent, cela est dû à des mises en œuvre contradictoires de la Promesse. Envisagez de remplacer la mise en œuvre globale de Promise par votre propre mise en œuvre, par exemple "),s("code",[e._v("global.Promise = jest.requireActual('promise');")]),e._v(" et/ou consolidez les bibliothèques Promise utilisées en une seule.")]),e._v(" "),s("p",[e._v("Si votre test est long, vous pouvez envisager d'augmenter le délai d'attente en appelant \"jest.setTimeout\".")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[e._v("jest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("10000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// 10 second timeout")]),e._v("\n")])])]),s("h2",{attrs:{id:"questions-relatives-aux-gardiens"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#questions-relatives-aux-gardiens"}},[e._v("#")]),e._v(" Questions relatives aux gardiens")]),e._v(" "),s("p",[e._v("Essayez de lancer Jest avec "),s("RouterLink",{attrs:{to:"/jest/Guides/CLI.html#--watchman"}},[s("code",[e._v("--no-watchman")])]),e._v(" ou mettez l'option de configuration "),s("code",[e._v("watchman")]),e._v(" à "),s("code",[e._v("false")]),e._v(".")],1),e._v(" "),s("p",[e._v("Voir également "),s("a",{attrs:{href:"https://facebook.github.io/watchman/docs/troubleshooting",target:"_blank",rel:"noopener noreferrer"}},[e._v("watchman troubleshooting"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"les-tests-sont-extremement-lents-sur-le-serveur-docker-et-ou-d-integration-continue-ic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#les-tests-sont-extremement-lents-sur-le-serveur-docker-et-ou-d-integration-continue-ic"}},[e._v("#")]),e._v(" Les tests sont extrêmement lents sur le serveur Docker et/ou d'intégration continue (IC).")]),e._v(" "),s("p",[e._v("Bien que Jest soit la plupart du temps extrêmement rapide sur les ordinateurs modernes multicœurs dotés de SSD rapides, il peut être lent sur certaines configurations, comme l'ont découvert nos utilisateurs (https://github.com/facebook/jest/issues/1395) (https://github.com/facebook/jest/issues/1524#issuecomment-260246008).")]),e._v(" "),s("p",[e._v("Sur la base des "),s("a",{attrs:{href:"https://github.com/facebook/jest/issues/1524#issuecomment-262366820",target:"_blank",rel:"noopener noreferrer"}},[e._v("conclusions"),s("OutboundLink")],1),e._v(", une façon d'atténuer ce problème et d'améliorer la vitesse de 50% est d'effectuer des tests de manière séquentielle.")]),e._v(" "),s("p",[e._v("Pour ce faire, vous pouvez effectuer des tests dans le même fil en utilisant "),s("RouterLink",{attrs:{to:"/jest/Guides/CLI.html#--runinband"}},[s("code",[e._v("--runInBand")])]),e._v(" :")],1),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Utilisation de Jest CLI")]),e._v("\njest --runInBand\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Utilisation du test yark (e.g. with create-react-app)")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("yarn")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("test")]),e._v(" --runInBand\n")])])]),s("p",[e._v("Une autre solution pour accélérer le temps d'exécution des tests sur les serveurs d'intégration continue tels que Travis-CI consiste à fixer le nombre maximum de travailleurs à ~"),s("em",[e._v("4")]),e._v(". Sur Travis-CI en particulier, cela peut réduire de moitié le temps d'exécution des tests. Note : Le plan Travis CI "),s("em",[e._v("libre")]),e._v(" disponible pour les projets open source ne comprend que 2 cœurs de processeur.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Utilisation de Jest CLI")]),e._v("\njest --maxWorkers"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("4")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Utilisation du test yarn (e.g. with create-react-app)")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("yarn")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("test")]),e._v(" --maxWorkers"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("4")]),e._v("\n")])])]),s("h2",{attrs:{id:"coveragepathignorepatterns-semble-n-avoir-aucun-effet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#coveragepathignorepatterns-semble-n-avoir-aucun-effet"}},[e._v("#")]),e._v(" "),s("code",[e._v("coveragePathIgnorePatterns")]),e._v(" semble n'avoir aucun effet.")]),e._v(" "),s("p",[e._v("Assurez-vous que vous n'utilisez pas le plugin "),s("code",[e._v("babel-plugin-istanbul")]),e._v(". Jest enveloppe Istanbul, et donc dit aussi à Istanbul quels fichiers à instrumenter avec la collection de couverture. Lorsque vous utilisez le plugin "),s("code",[e._v("Babel-plugin-istanbul")]),e._v(", chaque fichier qui est traité par Babel aura un code de collecte de couverture, et ne sera donc pas ignoré par les "),s("code",[e._v("coveragePathIgnorePatterns")]),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"definir-les-tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#definir-les-tests"}},[e._v("#")]),e._v(" Définir les tests")]),e._v(" "),s("p",[e._v("Les tests doivent être définis de manière synchrone pour que Jest puisse collecter vos tests.")]),e._v(" "),s("p",[e._v("À titre d'exemple pour montrer pourquoi c'est le cas, imaginez que nous écrivions un test comme ça :")]),e._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Don't do this it will not work")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("it")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'passes'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=>")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("expect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("toBe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("p",[e._v("Lorsque Jest exécute votre test pour collecter les "),s("code",[e._v("tests")]),e._v(", il n'en trouvera aucun parce que nous avons réglé la définition pour qu'elle se produise de manière asynchrone à la prochaine coche de la boucle d'événement.")]),e._v(" "),s("p",[e._v("Note : Cela signifie que lorsque vous utilisez "),s("code",[e._v("test.each")]),e._v(", vous ne pouvez pas définir la table de manière asynchrone dans un "),s("code",[e._v("beforeEach")]),e._v(" / "),s("code",[e._v("beforeAll")]),e._v(".")]),e._v(" "),s("h2",{attrs:{id:"toujours-pas-resolu"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#toujours-pas-resolu"}},[e._v("#")]),e._v(" Toujours pas résolu ?")]),e._v(" "),s("p",[e._v("Voir "),s("RouterLink",{attrs:{to:"/help.html"}},[e._v("Aide")]),e._v(".")],1)])}),[],!1,null,null,null);t.default=n.exports}}]);