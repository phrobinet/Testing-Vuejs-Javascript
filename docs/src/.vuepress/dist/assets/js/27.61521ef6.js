(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{377:function(t,s,e){"use strict";e.r(s);var n=e(42),a=Object(n.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"tests-instantanes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tests-instantanes"}},[t._v("#")]),t._v(" Tests instantanés")]),t._v(" "),e("p",[t._v("Les tests instantanés sont un outil très utile lorsque vous voulez vous assurer que votre UI ne change pas de manière inattendue.")]),t._v(" "),e("p",[t._v("Un scénario de test snapshot typique rend un composant de l'interface utilisateur, prend un instantané, puis le compare à un fichier snapshot de référence stocké à côté du test. Le test échouera si les deux instantanés ne correspondent pas : soit le changement est inattendu, soit l'instantané de référence doit être mis à jour avec la nouvelle version du composant de l'interface utilisateur.")]),t._v(" "),e("h2",{attrs:{id:"test-instantane-avec-jest"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#test-instantane-avec-jest"}},[t._v("#")]),t._v(" Test instantané avec Jest")]),t._v(" "),e("p",[t._v("Une approche similaire peut être adoptée lorsqu'il s'agit de tester vos composants React. Au lieu de rendre l'interface graphique, ce qui nécessiterait de construire l'application entière, vous pouvez utiliser un moteur de rendu de test pour générer rapidement une valeur sérialisable pour votre arbre React. Considérez ce "),e("a",{attrs:{href:"https://github.com/facebook/jest/blob/master/examples/snapshot/__tests__/link.react.test.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("exemple de test"),e("OutboundLink")],1),t._v(" pour un "),e("a",{attrs:{href:"https://github.com/facebook/jest/blob/master/examples/snapshot/Link.react.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("composant de lien"),e("OutboundLink")],1),t._v(" :")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" React "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Link "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../Link.react'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" renderer "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-test-renderer'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'renders correctly'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tree "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderer\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Link page"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.facebook.com"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Facebook"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Link"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSON")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tree"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatchSnapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("La première fois que ce test est effectué, Jest crée un [fichier instantané] (https://github.com/facebook/jest/blob/master/examples/snapshot/"),e("strong",[t._v("tests")]),t._v("/"),e("strong",[t._v("snapshots")]),t._v("/link.react.test.js.snap) qui ressemble à ceci :")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("renders correctly 1")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n<a\n  className="normal"\n  href="http://www.facebook.com"\n  onMouseEnter={[Function]}\n  onMouseLeave={[Function]}\n>\n  Facebook\n</a>\n')]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("L'artefact instantané doit être commis en même temps que les changements de code, et examiné dans le cadre de votre processus de révision du code. Jest utilise [pretty-format] (https://github.com/facebook/jest/tree/master/packages/pretty-format) pour rendre les instantanés lisibles par l'homme pendant la révision du code. Lors des tests suivants, Jest compare la sortie rendue avec l'instantané précédent. S'ils correspondent, le test sera réussi. S'ils ne correspondent pas, soit le testeur a trouvé un bug dans votre code (dans ce cas, c'est le composant "),e("code",[t._v("<Link>")]),t._v(") qui doit être corrigé, soit l'implémentation a changé et l'instantané doit être mis à jour.")]),t._v(" "),e("blockquote",[e("p",[t._v("Note : L'instantané est directement lié aux données que vous rendez - dans notre exemple, il s'agit du composant "),e("code",[t._v("<Link />")]),t._v(" avec le page prop qui lui est passé. Cela implique que même si un autre fichier a des accessoires manquants (disons, "),e("code",[t._v("App.js")]),t._v(") dans le composant "),e("code",[t._v("<Link />")]),t._v(", il passera quand même le test car le test ne connaît pas l'utilisation du composant "),e("code",[t._v("<Link />")]),t._v(" et il est seulement limité au composant "),e("code",[t._v("Link.react.js")]),t._v(". De plus, rendre le même composant avec des accessoires différents dans d'autres tests d'instantanés n'affectera pas le premier, car les tests ne se connaissent pas entre eux.")])]),t._v(" "),e("p",[t._v("Vous trouverez plus d'informations sur le fonctionnement des tests instantanés et sur la raison pour laquelle nous les avons mis en place sur le [release blog post] (https://jestjs.io/blog/2016/07/27/jest-14.html). Nous vous recommandons de lire [ce billet] (http://benmccormick.org/2016/09/19/testing-with-jest-snapshots-first-impressions/) pour avoir une bonne idée du moment où vous devriez utiliser les tests d'instantanés. Nous vous recommandons également de regarder cette [vidéo egghead] (https://egghead.io/lessons/javascript-use-jest-s-snapshot-testing-feature?pl=testing-javascript-with-jest-a36c4074) sur le test instantané avec Jest.")]),t._v(" "),e("h3",{attrs:{id:"mise-a-jour-des-instantanes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mise-a-jour-des-instantanes"}},[t._v("#")]),t._v(" Mise à jour des instantanés")]),t._v(" "),e("p",[t._v("Il est facile de repérer quand un test instantané échoue après l'introduction d'un bug. Lorsque cela se produit, corrigez le problème et assurez-vous que vos tests instantanés sont à nouveau réussis. Maintenant, parlons du cas où un test instantané échoue à cause d'un changement intentionnel de l'implémentation.")]),t._v(" "),e("p",[t._v("Une telle situation peut se produire si nous modifions intentionnellement l'adresse vers laquelle le composant Link de notre exemple pointe.")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Cas test mis à jour avec un lien vers une adresse différente")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'renders correctly'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tree "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderer\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Link page"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://www.instagram.com"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Instagram"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Link"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSON")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tree"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatchSnapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Dans ce cas, Jest imprimera cette sortie :")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/content/failedSnapshotTest.png",alt:""}})]),t._v(" "),e("p",[t._v("Comme nous venons de mettre à jour notre composant pour qu'il pointe vers une adresse différente, il est raisonnable de s'attendre à des changements dans l'instantané de ce composant. Notre scénario de test de l'instantané échoue parce que l'instantané de notre composant mis à jour ne correspond plus à l'artefact de l'instantané de ce scénario de test.")]),t._v(" "),e("p",[t._v("Pour résoudre ce problème, nous devrons mettre à jour nos artefacts d'instantané. Vous pouvez lancer Jest avec un drapeau qui lui indiquera de générer à nouveau des instantanés :")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("jest --updateSnapshot\n")])])]),e("p",[t._v("Allez-y et acceptez les changements en exécutant la commande ci-dessus. Vous pouvez également utiliser l'équivalent du drapeau "),e("code",[t._v("-u")]),t._v(" à un seul caractère pour générer à nouveau des instantanés si vous préférez. Cela permettra de générer à nouveau des artefacts d'instantanés pour tous les tests d'instantanés qui échouent. Si nous avions d'autres échecs de tests d'instantanés à cause d'un bug involontaire, nous aurions besoin de corriger le bug avant de re-générer des instantanés pour éviter d'enregistrer des instantanés du comportement bogué.")]),t._v(" "),e("p",[t._v("Si vous souhaitez limiter les cas de tests snapshot à re-générer, vous pouvez passer un drapeau supplémentaire "),e("code",[t._v("--testNamePattern")]),t._v(" pour ne ré-enregistrer des snapshots que pour les tests qui correspondent au pattern.")]),t._v(" "),e("p",[t._v('Vous pouvez tester cette fonctionnalité en clonant le [snapshot example] (https://github.com/facebook/jest/tree/master/examples/snapshot), en modifiant le composant "Link" et en lançant Jest.')]),t._v(" "),e("h3",{attrs:{id:"mode-instantane-interactif"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mode-instantane-interactif"}},[t._v("#")]),t._v(" Mode instantané interactif")]),t._v(" "),e("p",[t._v("Les clichés ratés peuvent également être mis à jour de manière interactive en mode veille :")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/content/interactiveSnapshot.png",alt:""}})]),t._v(" "),e("p",[t._v("Une fois que vous entrez dans le mode instantané interactif, Jest vous fera passer les instantanés ratés un test à la fois et vous donnera la possibilité de revoir les résultats ratés.")]),t._v(" "),e("p",[t._v("De là, vous pouvez choisir de mettre à jour cet instantané ou de passer au suivant :")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/content/interactiveSnapshotUpdate.gif",alt:""}})]),t._v(" "),e("p",[t._v("Une fois que vous aurez terminé, Jest vous donnera un résumé avant de revenir au mode de surveillance :")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/content/interactiveSnapshotDone.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"instantanes-en-ligne"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#instantanes-en-ligne"}},[t._v("#")]),t._v(" Instantanés en ligne")]),t._v(" "),e("p",[t._v('Les instantanés en ligne se comportent de manière identique aux instantanés externes (fichiers "snap"), sauf que les valeurs des instantanés sont automatiquement réécrites dans le code source. Cela signifie que vous pouvez bénéficier des avantages des instantanés générés automatiquement sans avoir à passer à un fichier externe pour vous assurer que la bonne valeur a été écrite.')]),t._v(" "),e("blockquote",[e("p",[t._v("Les photos en ligne sont alimentées par [Prettier] (https://prettier.io). Pour utiliser les instantanés en ligne, vous devez avoir installé "),e("code",[t._v("prettier")]),t._v(" dans votre projet. Votre configuration Prettier sera respectée lors de l'écriture des fichiers de test.")]),t._v(" "),e("p",[t._v("Si vous avez installé "),e("code",[t._v("prettier")]),t._v(" dans un endroit où Jest ne peut pas le trouver, vous pouvez lui dire comment le trouver en utilisant la propriété de configuration "),e("RouterLink",{attrs:{to:"/jest/Guides/Configuration.html#prettierpath-string"}},[e("code",[t._v('"prettierPath"')])]),t._v(".")],1)]),t._v(" "),e("p",[e("strong",[t._v("Exemple :")])]),t._v(" "),e("p",[t._v("D'abord, vous écrirez un test, en appelant "),e("code",[t._v(".toMatchInlineSnapshot()")]),t._v(" sans arguments :")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'renders correctly'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tree "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderer\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Link page"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://prettier.io"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Prettier"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Link"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSON")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tree"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatchInlineSnapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("La prochaine fois que vous lancerez Jest, "),e("code",[t._v("tree")]),t._v(" sera évalué, et un snapshot sera écrit en argument de "),e("code",[t._v("toMatchInlineSnapshot")]),t._v(" :")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'renders correctly'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tree "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" renderer\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("create")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Link page"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://prettier.io"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Prettier"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Link"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSON")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tree"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatchInlineSnapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n<a\n  className="normal"\n  href="https://prettier.io"\n  onMouseEnter={[Function]}\n  onMouseLeave={[Function]}\n>\n  Prettier\n</a>\n')]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("C'est tout ce qu'il y a à faire ! Vous pouvez même mettre à jour les snapshots avec "),e("code",[t._v("--updateSnapshot")]),t._v(" ou en utilisant la touche "),e("code",[t._v("u")]),t._v(" en mode "),e("code",[t._v("--watch")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"les-matchers-de-propriete"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#les-matchers-de-propriete"}},[t._v("#")]),t._v(" Les matchers de propriété")]),t._v(" "),e("p",[t._v("Souvent, l'objet que vous souhaitez photographier comporte des champs qui sont générés (comme les ID et les dates). Si vous essayez de prendre un instantané de ces objets, ils forceront l'instantané à échouer à chaque exécution :")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'will fail every time'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" user "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    createdAt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Math"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("floor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'LeBron James'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatchSnapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Snapshot")]),t._v("\nexports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("will fail every time 1")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\nObject {\n  "createdAt": 2018-05-19T23:36:09.816Z,\n  "id": 3,\n  "name": "LeBron James",\n}\n')]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Pour ces cas, Jest permet de fournir un appariement asymétrique pour n'importe quel bien. Ces correspondances sont vérifiées avant que l'instantané ne soit écrit ou testé, puis enregistrées dans le fichier de l'instantané au lieu de la valeur reçue :")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'will check the matchers and pass'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" user "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    createdAt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Math"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("floor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'LeBron James'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatchSnapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    createdAt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" expect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("any")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    id"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" expect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("any")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Number"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Snapshot")]),t._v("\nexports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("will check the matchers and pass 1")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\nObject {\n  "createdAt": Any<Date>,\n  "id": Any<Number>,\n  "name": "LeBron James",\n}\n')]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Toute valeur donnée qui n'est pas une correspondance sera vérifiée exactement et enregistrée dans l'instantané :")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'will check the values and pass'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" user "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    createdAt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Bond... James Bond'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatchSnapshot")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    createdAt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" expect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("any")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Bond... James Bond'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Snapshot")]),t._v("\nexports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("will check the values and pass 1")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('\nObject {\n  "createdAt": Any<Date>,\n  "name": \'Bond... James Bond\',\n}\n')]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"meilleures-pratiques"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#meilleures-pratiques"}},[t._v("#")]),t._v(" Meilleures pratiques")]),t._v(" "),e("p",[t._v("Les instantanés sont un outil fantastique pour identifier les changements d'interface inattendus au sein de votre application - que cette interface soit une réponse API, une interface utilisateur, des journaux ou des messages d'erreur. Comme pour toute stratégie de test, il existe des bonnes pratiques que vous devez connaître et des directives que vous devez suivre pour les utiliser efficacement.")]),t._v(" "),e("h3",{attrs:{id:"_1-traiter-les-instantanes-comme-du-code"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-traiter-les-instantanes-comme-du-code"}},[t._v("#")]),t._v(" 1. Traiter les instantanés comme du code")]),t._v(" "),e("p",[t._v("Faites des instantanés et examinez-les dans le cadre de votre processus régulier de révision du code. Cela signifie que vous devez traiter les instantanés comme n'importe quel autre type de test ou de code dans votre projet.")]),t._v(" "),e("p",[t._v("Assurez-vous que vos instantanés sont lisibles en les gardant concentrés, courts, et en utilisant des outils qui font respecter ces conventions stylistiques.")]),t._v(" "),e("p",[t._v("Comme mentionné précédemment, Jest utilise "),e("a",{attrs:{href:"https://yarnpkg.com/en/package/pretty-format",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("pretty-format")]),e("OutboundLink")],1),t._v(" pour rendre les instantanés lisibles par l'homme, mais vous pouvez trouver utile d'introduire des outils supplémentaires, comme "),e("a",{attrs:{href:"https://yarnpkg.com/en/package/eslint-plugin-jest",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("eslint-plugin-jest")]),e("OutboundLink")],1),t._v(" avec son option "),e("a",{attrs:{href:"https://github.com/jest-community/eslint-plugin-jest/blob/master/docs/rules/no-large-snapshots.md",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("no-large-snapshots")]),e("OutboundLink")],1),t._v(", ou "),e("a",{attrs:{href:"https://yarnpkg.com/en/package/snapshot-diff",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("snapshot-diff")]),e("OutboundLink")],1),t._v(" avec sa fonction de comparaison d'instantanés de composants, afin de promouvoir des affirmations courtes et ciblées.")]),t._v(" "),e("p",[t._v("L'objectif est de faciliter l'examen des instantanés dans les requêtes pull, et de lutter contre l'habitude de régénérer les instantanés lorsque les suites de test échouent au lieu d'examiner les causes profondes de leur échec.")]),t._v(" "),e("h3",{attrs:{id:"_2-les-tests-doivent-etre-deterministes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-les-tests-doivent-etre-deterministes"}},[t._v("#")]),t._v(" 2. Les tests doivent être déterministes")]),t._v(" "),e("p",[t._v("Vos tests doivent être déterministes. Exécuter les mêmes tests plusieurs fois sur un composant qui n'a pas changé devrait produire les mêmes résultats à chaque fois. Vous devez vous assurer que les instantanés générés ne contiennent pas de données spécifiques à la plate-forme ou d'autres données non déterministes.")]),t._v(" "),e("p",[t._v("Par exemple, si vous avez un composant "),e("a",{attrs:{href:"https://github.com/facebook/jest/blob/master/examples/snapshot/Clock.react.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Clock"),e("OutboundLink")],1),t._v(" qui utilise "),e("code",[t._v("Date.now()")]),t._v(", l'instantané généré par ce composant sera différent à chaque fois que le scénario de test sera exécuté. Dans ce cas, nous pouvons "),e("RouterLink",{attrs:{to:"/jest/Guides/MockFunctions.html"}},[t._v("simuler la méthode Date.now()")]),t._v(" pour renvoyer une valeur cohérente à chaque fois que le test est exécuté :")],1),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("Date"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("now "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jest"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1482363367071")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Maintenant, à chaque fois que le scénario de test de l'instantané est exécuté, "),e("code",[t._v("Date.now()")]),t._v(" renverra "),e("code",[t._v("1482363367071")]),t._v(" de manière cohérente. Cela aura pour conséquence de générer le même instantané pour ce composant, quel que soit le moment où le test est exécuté.")]),t._v(" "),e("h3",{attrs:{id:"_3-utiliser-des-noms-d-instantanes-descriptifs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-utiliser-des-noms-d-instantanes-descriptifs"}},[t._v("#")]),t._v(" 3. Utiliser des noms d'instantanés descriptifs")]),t._v(" "),e("p",[t._v("Essayez toujours d'utiliser des noms de tests descriptifs et/ou de clichés pour les instantanés. Les meilleurs noms décrivent le contenu attendu de l'instantané. Il est ainsi plus facile pour les examinateurs de vérifier les instantanés pendant l'examen, et pour quiconque de savoir si un instantané périmé est ou non le bon comportement avant la mise à jour.")]),t._v(" "),e("p",[t._v("Par exemple, comparer :")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<UserName /> should handle some test case")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nexports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<UserName /> should handle some other test case")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n<div>\n  Alan Turing\n</div>\n")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("A L'adresse suivante :")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<UserName /> should render null")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nexports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<UserName /> should render Alan Turing")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n<div>\n  Alan Turing\n</div>\n")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Comme ce dernier décrit exactement ce qui est attendu dans le résultat, il est plus clair de voir quand il est erroné :")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("exports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<UserName /> should render null")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n<div>\n  Alan Turing\n</div>\n")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nexports"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("<UserName /> should render Alan Turing")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token template-string"}},[e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"foire-aux-questions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#foire-aux-questions"}},[t._v("#")]),t._v(" Foire aux questions")]),t._v(" "),e("h3",{attrs:{id:"les-instantanes-sont-ils-ecrits-automatiquement-sur-les-systemes-d-integration-continue-ic"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#les-instantanes-sont-ils-ecrits-automatiquement-sur-les-systemes-d-integration-continue-ic"}},[t._v("#")]),t._v(" Les instantanés sont-ils écrits automatiquement sur les systèmes d'intégration continue (IC) ?")]),t._v(" "),e("p",[t._v("Non, à partir de Jest 20, les snapshots dans Jest ne sont pas automatiquement écrits lorsque Jest est exécuté dans un système de CI sans passer explicitement par "),e("code",[t._v("--updateSnapshot")]),t._v(". On s'attend à ce que tous les snapshots fassent partie du code qui est exécuté sur le CI et comme les nouveaux snapshots passent automatiquement, ils ne devraient pas passer un test sur un système de CI. Il est recommandé de toujours valider tous les instantanés et de les garder sous contrôle de version.")]),t._v(" "),e("h3",{attrs:{id:"faut-il-commettre-des-instantanes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#faut-il-commettre-des-instantanes"}},[t._v("#")]),t._v(" Faut-il commettre des instantanés ?")]),t._v(" "),e("p",[t._v("Oui, tous les fichiers d'instantanés doivent être validés en même temps que les modules qu'ils couvrent et leurs tests. Ils doivent être considérés comme faisant partie d'un test, tout comme la valeur de toute autre affirmation dans Jest. En fait, les instantanés représentent l'état des modules sources à un moment donné. De cette façon, lorsque les modules sources sont modifiés, Jest peut dire ce qui a changé par rapport à la version précédente. Il peut également fournir beaucoup de contexte supplémentaire pendant la révision du code, dans lequel les réviseurs peuvent mieux étudier vos changements.")]),t._v(" "),e("h3",{attrs:{id:"est-ce-que-les-tests-instantanes-ne-fonctionnent-qu-avec-les-composants-react"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#est-ce-que-les-tests-instantanes-ne-fonctionnent-qu-avec-les-composants-react"}},[t._v("#")]),t._v(" Est-ce que les tests instantanés ne fonctionnent qu'avec les composants React ?")]),t._v(" "),e("p",[t._v("Les composants "),e("RouterLink",{attrs:{to:"/jest/Guides/TutorialReact.html"}},[t._v("React")]),t._v(" et "),e("RouterLink",{attrs:{to:"/jest/Guides/TutorialReactNative.html"}},[t._v("React Native")]),t._v(" sont un bon cas d'utilisation pour les tests d'instantanés. Cependant, les instantanés peuvent capturer n'importe quelle valeur sérialisable et doivent être utilisés chaque fois que l'objectif est de tester si la sortie est correcte. Le dépôt Jest contient de nombreux exemples de test de la sortie de Jest lui-même, de la sortie de la bibliothèque d'assertions de Jest ainsi que des messages de log de diverses parties de la base de code de Jest. Voir un exemple de "),e("a",{attrs:{href:"https://github.com/facebook/jest/blob/master/e2e/__tests__/console.test.ts",target:"_blank",rel:"noopener noreferrer"}},[t._v("snapshotting CLI output"),e("OutboundLink")],1),t._v(" dans le dépôt Jest.")],1),t._v(" "),e("h3",{attrs:{id:"quelle-est-la-difference-entre-un-test-d-instantane-et-un-test-de-regression-visuelle"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quelle-est-la-difference-entre-un-test-d-instantane-et-un-test-de-regression-visuelle"}},[t._v("#")]),t._v(" Quelle est la différence entre un test d'instantané et un test de régression visuelle ?")]),t._v(" "),e("p",[t._v("Les tests instantanés et les tests de régression visuelle sont deux moyens distincts de tester les interfaces utilisateur, et ils servent des objectifs différents. Les outils de test de régression visuelle prennent des captures d'écran de pages web et comparent les images résultantes pixel par pixel. Avec le test Snapshot, les valeurs sont sérialisées, stockées dans des fichiers texte et comparées à l'aide d'un algorithme de diffraction. Il y a différents compromis à considérer et nous avons énuméré les raisons pour lesquelles les tests instantanés ont été construits dans le [Jest blog] (https://jestjs.io/blog/2016/07/27/jest-14.html#why-snapshot-testing).")]),t._v(" "),e("h3",{attrs:{id:"les-tests-instantanes-remplacent-ils-les-tests-unitaires"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#les-tests-instantanes-remplacent-ils-les-tests-unitaires"}},[t._v("#")]),t._v(" Les tests instantanés remplacent-ils les tests unitaires ?")]),t._v(" "),e("p",[t._v("Le test instantané n'est qu'une des 20 affirmations qui accompagnent Jest. L'objectif des tests instantanés n'est pas de remplacer les tests unitaires existants, mais d'apporter une valeur ajoutée et de rendre les tests indolores. Dans certains scénarios, les tests instantanés peuvent potentiellement supprimer la nécessité de tests unitaires pour un ensemble particulier de fonctionnalités (par exemple, les composants de réaction), mais ils peuvent également fonctionner ensemble.")]),t._v(" "),e("h3",{attrs:{id:"quelles-sont-les-performances-des-tests-d-instantanes-en-ce-qui-concerne-la-vitesse-et-la-taille-des-fichiers-generes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#quelles-sont-les-performances-des-tests-d-instantanes-en-ce-qui-concerne-la-vitesse-et-la-taille-des-fichiers-generes"}},[t._v("#")]),t._v(" Quelles sont les performances des tests d'instantanés en ce qui concerne la vitesse et la taille des fichiers générés ?")]),t._v(" "),e("p",[t._v("Jest a été réécrit dans un souci de performance, et les tests d'instantanés ne font pas exception. Comme les instantanés sont stockés dans des fichiers texte, cette méthode de test est rapide et fiable. Jest génère un nouveau fichier pour chaque fichier de test qui invoque le \"MatchSnapshot\". La taille des snapshots est assez petite : Pour référence, la taille de tous les fichiers d'instantanés dans la base de code de Jest elle-même est inférieure à 300 Ko.")]),t._v(" "),e("h3",{attrs:{id:"comment-resoudre-les-conflits-dans-les-fichiers-d-instantanes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#comment-resoudre-les-conflits-dans-les-fichiers-d-instantanes"}},[t._v("#")]),t._v(" Comment résoudre les conflits dans les fichiers d'instantanés ?")]),t._v(" "),e("p",[t._v("Les fichiers d'instantanés doivent toujours représenter l'état actuel des modules qu'ils couvrent. Par conséquent, si vous fusionnez deux branches et que vous rencontrez un conflit dans les fichiers d'instantanés, vous pouvez soit résoudre le conflit manuellement, soit mettre à jour le fichier d'instantanés en exécutant Jest et en inspectant le résultat.")]),t._v(" "),e("h3",{attrs:{id:"est-il-possible-d-appliquer-les-principes-de-developpement-pilote-par-les-tests-avec-des-tests-instantanes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#est-il-possible-d-appliquer-les-principes-de-developpement-pilote-par-les-tests-avec-des-tests-instantanes"}},[t._v("#")]),t._v(" Est-il possible d'appliquer les principes de développement piloté par les tests avec des tests instantanés ?")]),t._v(" "),e("p",[t._v("Bien qu'il soit possible d'écrire des fichiers d'instantanés manuellement, cela n'est généralement pas envisageable. Les instantanés aident à déterminer si la sortie des modules couverts par les tests est modifiée, plutôt que de donner des conseils pour concevoir le code en premier lieu.")]),t._v(" "),e("h3",{attrs:{id:"la-couverture-de-code-fonctionne-t-elle-avec-les-tests-instantanes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#la-couverture-de-code-fonctionne-t-elle-avec-les-tests-instantanes"}},[t._v("#")]),t._v(" La couverture de code fonctionne-t-elle avec les tests instantanés ?")]),t._v(" "),e("p",[t._v("Oui, ainsi qu'avec tout autre test.")])])}),[],!1,null,null,null);s.default=a.exports}}]);