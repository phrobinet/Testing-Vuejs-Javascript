(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{475:function(t,s,e){"use strict";e.r(s);var a=e(42),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"utilisation-avec-typescript"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#utilisation-avec-typescript"}},[t._v("#")]),t._v(" Utilisation avec TypeScript")]),t._v(" "),e("blockquote",[e("p",[t._v("Un exemple de projet pour cette installation est disponible sur "),e("a",{attrs:{href:"https://github.com/vuejs/vue-test-utils-typescript-example",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("p",[t._v("TypeScript est un sur-ensemble populaire de JavaScript qui ajoute des types et des classes en plus des JS ordinaires. Vue Test Utils inclut les types dans le paquet distribué, donc il fonctionne bien avec TypeScript.")]),t._v(" "),e("p",[t._v("Dans ce guide, nous expliquerons comment configurer un dispositif de test pour un projet TypeScript en utilisant Jest et Vue Test Utils à partir d'une configuration de base de Vue CLI TypeScript.")]),t._v(" "),e("h3",{attrs:{id:"ajout-de-typescript"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ajout-de-typescript"}},[t._v("#")]),t._v(" Ajout de TypeScript")]),t._v(" "),e("p",[t._v("Vous devez d'abord créer un projet. SI vous n'avez pas installé Vue CLI, installez-le globalement :")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g @vue/cli\n")])])]),e("p",[t._v("Et créer un projet avec :")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("$ vue create hello-world\n")])])]),e("p",[t._v("Dans l’invite du CLI, choisissez de "),e("code",[t._v("Manually select features")]),t._v(", sélectionnez TypeScript et appuyez sur la touche enter. Cela créera un projet avec TypeScript déjà configuré.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("Si vous souhaitez obtenir un guide plus détaillé sur la configuration de Vue avec TypyScript, consultez le "),e("a",{attrs:{href:"https://github.com/Microsoft/TypeScript-Vue-Starter",target:"_blank",rel:"noopener noreferrer"}},[t._v("guide de démarrage de Vue avec TypeScript"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("p",[t._v("L'étape suivante consiste d'ajouter Jest au projet.")]),t._v(" "),e("h3",{attrs:{id:"mise-en-place-de-jest"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mise-en-place-de-jest"}},[t._v("#")]),t._v(" Mise en place de Jest")]),t._v(" "),e("p",[t._v("Jest est un outil de test développer par Facebook, visant à fournir une solution de test unitaire sur batterie. Vous pouvez en savoir plus sur Jest en consultant sa "),e("a",{attrs:{href:"https://jestjs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("documentation officielle"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Installez Jest et Vue Test Utils :")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev jest @vue/test-utils\n")])])]),e("p",[t._v("Définissez ensuite un script "),e("code",[t._v("test:unit")]),t._v(" dans le fichier "),e("code",[t._v("package.json")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// package.json")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ..")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ..")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test:unit"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jest"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ..")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"traitement-des-composants-monofichiers-dans-jest"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#traitement-des-composants-monofichiers-dans-jest"}},[t._v("#")]),t._v(" Traitement des composants monofichiers dans Jest")]),t._v(" "),e("p",[t._v("Pour apprend à Jest comment traiter les fichiers "),e("code",[t._v("*.vue")]),t._v(", nous devons installer et configurer le préprocesseur "),e("code",[t._v("vue-jest")]),t._v(" :")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev vue-jest\n")])])]),e("p",[t._v("Ensuite, créez un bloc "),e("code",[t._v("jest")]),t._v(" dans "),e("code",[t._v("package.json")]),t._v(" :")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"jest"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"moduleFileExtensions"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ts"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"json"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dites à Jest de gérer les fichiers `*.vue`")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transform"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// traiter les fichiers `*.vue` avec `vue-jest`")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('".*\\\\.(vue)$"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-jest"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"testURL"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost/"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"configuration-de-typescript-pour-jest"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration-de-typescript-pour-jest"}},[t._v("#")]),t._v(" Configuration de TypeScript pour Jest")]),t._v(" "),e("p",[t._v("Afin d'utiliser les fichiers TypeScript dans les tests, nous devons configurer Jest pour qu'il compile le TypeScript. Pour cela, nous devons installer "),e("code",[t._v("ts-jest")]),t._v(" :")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev ts-jest\n")])])]),e("p",[t._v("Ensuite, nous devons dire à Jest de traiter les fichiers de test TypeScript avec "),e("code",[t._v("ts-jest")]),t._v(" en ajoutant une entrée sous "),e("code",[t._v("jest.transform")]),t._v(" dans "),e("code",[t._v("package.json")]),t._v(" :")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"jest"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"transform"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// traiter les fichiers `*.ts` avec `ts-jest`")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"^.+\\\\.tsx?$"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ts-jest"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"placement-des-dossiers-de-test"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#placement-des-dossiers-de-test"}},[t._v("#")]),t._v(" Placement des dossiers de test")]),t._v(" "),e("p",[t._v("Par défaut, Jest récupère récursivement tous les fichiers qui ont une extension "),e("code",[t._v(".spec.js")]),t._v("ou "),e("code",[t._v(".test.js")]),t._v(" dans l'ensemble du projet.")]),t._v(" "),e("p",[t._v("Pour exécuter des fichiers de test avec une extension "),e("code",[t._v(".ts")]),t._v(", nous devons modifier le "),e("code",[t._v("testRegex")]),t._v(" dans la section de configuration du fichier "),e("code",[t._v("package.json")]),t._v(".")]),t._v(" "),e("p",[t._v("Ajoutez ce qui suit dans le champ "),e("code",[t._v("jest")]),t._v(" du fichier "),e("code",[t._v("package.json")]),t._v(" :")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"jest"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"testRegex"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Jest recommande de créer un répertoire "),e("code",[t._v("__tests__")]),t._v(" juste à côté du code testé, mais n'hésitez pas à structurer vos tests comme bon vous semble. Attention, Jest crée un répertoire "),e("code",[t._v("__snapshots__")]),t._v(" à côté des fichiers de test qui effectuent les tests de snapshot.")]),t._v(" "),e("h3",{attrs:{id:"faire-un-test-unitaire"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#faire-un-test-unitaire"}},[t._v("#")]),t._v(" Faire un test unitaire")]),t._v(" "),e("p",[t._v("Maintenant que le projet est mis en place, il est temps d'écrire un test unitaire.")]),t._v(" "),e("p",[t._v("Créez un fichier "),e("code",[t._v("src/components/__tests__/HelloWorld.spec.ts")]),t._v(", et ajoutez le code suivant :")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// src/components/__tests__/HelloWorld.spec.ts")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" shallowMount "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@vue/test-utils'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" HelloWorld "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../HelloWorld.vue'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("describe")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HelloWorld.vue'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'renders props.msg when passed'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" msg "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'new message'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wrapper "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("shallowMount")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HelloWorld"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      propsData"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" msg "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wrapper"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toMatch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("msg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("C'est tout ce qui faut faire pour que TypeScript et Vue Test Utils travaillent ensemble !")]),t._v(" "),e("h3",{attrs:{id:"ressources"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ressources"}},[t._v("#")]),t._v(" Ressources")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/vuejs/vue-test-utils-typescript-example",target:"_blank",rel:"noopener noreferrer"}},[t._v("Exemple de projet pour cette configuration"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://jestjs.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jest"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);